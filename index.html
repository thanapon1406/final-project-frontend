<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      สำนักงานโครงการจัดหมู่บ้านตัวอย่างห้วยตึงเฒ่า อันเนื่องมาจากพระราชดำริ
    </title>

    <!-- Bootstrap 5.3.0 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Custom Icons -->
    <link rel="stylesheet" href="css/icons.css" />
    <!-- Thai Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css" />

    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="index.html">
          <!-- Will be loaded from JSON -->
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <!-- Will be loaded from JSON -->
          </ul>
        </div>
      </div>
    </nav>

    <!-- Carousel -->
    <div id="carouselMain" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-indicators">
        <!-- Will be loaded from JSON -->
      </div>
      <div class="carousel-inner">
        <!-- Will be loaded from JSON -->
      </div>
      <button
        class="carousel-control-prev"
        type="button"
        data-bs-target="#carouselMain"
        data-bs-slide="prev"
      >
        <span class="carousel-control-prev-icon"></span>
      </button>
      <button
        class="carousel-control-next"
        type="button"
        data-bs-target="#carouselMain"
        data-bs-slide="next"
      >
        <span class="carousel-control-next-icon"></span>
      </button>
    </div>

    <!-- News Marquee -->
    <div class="news-marquee">
      <div class="container-fluid">
        <marquee direction="left" scrollamount="3">
          <!-- Will be loaded from JSON -->
        </marquee>
      </div>
    </div>

    <!-- Main Content -->
    <main id="main-content">
      <!-- Hero Section -->
      <section class="hero-section">
        <!-- Particles background -->
        <div id="particles-js" style="position: absolute; width: 100%; height: 100%; z-index: 1;"></div>
        <div class="container" style="position: relative; z-index: 2;">
          <div class="row align-items-center">
            <div class="col-lg-6" data-aos="fade-right" data-aos-duration="1000">
              <div class="hero-content">
                <!-- Will be loaded from JSON -->
                <!-- Typing animation will be added here -->
                <div id="typed-title" class="typed-title"></div>
              </div>
            </div>
            <div class="col-lg-6" data-aos="fade-left" data-aos-duration="1000" data-aos-delay="300">
              <div class="hero-image">
                <div class="image-container position-relative">
                  <!-- Will be loaded from JSON -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Services Section -->
      <section id="services" class="py-5">
        <div class="container">
          <div class="row g-4 equal-height"></div>
            <!-- Will be loaded from JSON -->
          </div>
        </div>
      </section>



      <!-- News Section -->
      <section class="py-5">
        <div class="container" id="news">
          <div class="row">
            <div class="col-12" data-aos="fade-up">
              <h2 class="section-title text-center mb-4">ข่าวสาร</h2>
              <div class="table-responsive">
                <table class="table table-striped table-hover">
                  <thead>
                    <tr>
                      <th width="20%">วันที่</th>
                      <th width="80%">รายละเอียด</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Will be loaded from JSON -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- About Section -->
      <section id="about" class="section-bg-gray py-5">
        <div class="container">
          <div class="row">
            <div class="col-12" data-aos="fade-up">
              <h2 class="section-title">เกี่ยวกับเรา</h2>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-8 mx-auto" data-aos="fade-up" data-aos-delay="200">
              <div class="card shadow-lg">
                <div class="card-body">
                  <!-- Will be loaded from JSON -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Gallery Section -->
      <section id="gallery" class="py-5">
        <div class="container">
          <div class="row">
            <div class="col-12" data-aos="fade-up">
              <h2 class="section-title">ประมวลภาพ</h2>
              <p class="section-subtitle">
                ภาพบรรยากาศและกิจกรรมต่างๆ ที่ห้วยตึงเฒ่า
              </p>
            </div>
          </div>
          <div class="row g-3" id="gallery-container">
            <!-- Will be loaded from JSON -->
          </div>
        </div>
      </section>
    </main>

    <!-- Floating Action Button -->
    <div class="floating-btn-container">
      <button id="scrollToTop" class="btn btn-primary floating-btn" title="กลับไปด้านบน">
        <i class="bi bi-arrow-up"></i>
      </button>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="row">
          <div class="col-lg-8">
            <!-- Will be loaded from JSON -->
          </div>
          <div class="col-lg-4 text-end" id="footer-social">
            <!-- Will be loaded from JSON -->
          </div>
        </div>
      </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- AOS (Animate On Scroll) -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <!-- Typed.js for typing animation -->
    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>
    
    <!-- Swiper for advanced carousels -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css">
    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
    
    <!-- CountUp.js for number animations -->
    <script src="https://cdn.jsdelivr.net/npm/countup.js@2.6.2/dist/countUp.umd.js"></script>
    
    <!-- Particles.js for background effects -->
    <script src="https://cdn.jsdelivr.net/npm/particles.js@2.0.0/particles.min.js"></script>

    <!-- Shared JS -->
    <script src="js/shared.js"></script>

    <!-- Load Homepage Data from JSON -->
    <script>
      let carouselData = null;
      let newsData = null;
      let featuredData = null;
      let galleryData = null;
      let servicesData = null;
      let aboutData = null;

      // Load homepage-specific JSON data
      async function loadHomepageData() {
        try {
          const [carousel, news, featured, gallery, services, about] =
            await Promise.all([
              loadJsonData("homepage-carousel"),
              loadJsonData("homepage-news"),
              loadJsonData("homepage-featured"),
              loadJsonData("homepage-gallery"),
              loadJsonData("homepage-services"),
              loadJsonData("about-content"),
            ]);

          carouselData = carousel;
          newsData = news;
          featuredData = featured;
          galleryData = gallery;
          servicesData = services;
          aboutData = about;

          // Update page content
          updateCarousel();
          updateNews();
          updateFeatured();
          updateGallery();
          updateServices();
          updateAbout();

          console.log("Homepage data loaded successfully");
        } catch (error) {
          console.error("Error loading homepage data:", error);
        }
      }

      // Update carousel
      function updateCarousel() {
        if (!carouselData || !carouselData.slides) return;

        const carouselInner = document.querySelector(
          "#carouselMain .carousel-inner"
        );
        const carouselIndicators = document.querySelector(
          "#carouselMain .carousel-indicators"
        );

        if (!carouselInner || !carouselIndicators) return;

        // Clear existing content
        carouselInner.innerHTML = "";
        carouselIndicators.innerHTML = "";

        const activeSlides = carouselData.slides.filter(
          (slide) => slide.active
        );

        activeSlides.forEach((slide, index) => {
          // Create indicator
          const indicator = document.createElement("button");
          indicator.type = "button";
          indicator.setAttribute("data-bs-target", "#carouselMain");
          indicator.setAttribute("data-bs-slide-to", index);
          if (index === 0) indicator.classList.add("active");
          carouselIndicators.appendChild(indicator);

          // Create slide
          const slideDiv = document.createElement("div");
          slideDiv.className = `carousel-item ${index === 0 ? "active" : ""}`;
          slideDiv.innerHTML = `
            <img src="${slide.image || ""}" class="d-block w-100" alt="${
            slide.title
          }" 
                 width="1200" height="600"
                 onerror="this.onerror=null;this.src='data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%221200%22 height=%22600%22><rect width=%22100%25%22 height=%22100%25%22 fill=%22%23cccccc%22/><text x=%2250%25%22 y=%2250%25%22 font-size=%2248%22 text-anchor=%22middle%22 fill=%22%23666%22 dy=%22.3em%22>1200x600</text></svg>'">
            <div class="carousel-caption">
              <h3>${slide.title}</h3>
              <p>${slide.description}</p>
            </div>
          `;
          carouselInner.appendChild(slideDiv);
        });
      }

      // Update news section
      function updateNews() {
        if (!newsData) return;

        // Update marquee
        const marquee = document.querySelector(".news-marquee marquee");
        if (marquee && newsData.announcements) {
          const activeAnnouncements = newsData.announcements.filter(
            (a) => a.active
          );
          if (activeAnnouncements.length > 0) {
            marquee.innerHTML = activeAnnouncements
              .map((a) => `<strong>ประกาศ:</strong> ${a.text}`)
              .join(" &nbsp;&nbsp;&nbsp;&nbsp; ");
          }
        }

        // Update news table
        const newsTable = document.querySelector("#news tbody");
        if (newsTable && newsData.newsTable) {
          newsTable.innerHTML = "";
          newsData.newsTable.forEach((news) => {
            const row = document.createElement("tr");
            row.innerHTML = `
              <td><strong>${news.date}</strong></td>
              <td>${news.content}</td>
            `;
            newsTable.appendChild(row);
          });
        }
      }

      // Update featured content
      function updateFeatured() {
        if (!featuredData) return;

        // Update hero section
        if (featuredData.heroSection) {
          const heroContent = document.querySelector(".hero-content");
          const heroImage = document.querySelector(
            ".hero-image .image-container"
          );

          if (heroContent) {
            const hero = featuredData.heroSection;
            let buttonsHtml = "";
            if (hero.buttons) {
              buttonsHtml = `
                <div class="hero-buttons">
                  ${hero.buttons
                    .map(
                      (btn) => `
                    <a href="${btn.href}" class="${btn.class}">
                      <i class="${btn.icon} me-2"></i>${btn.text}
                    </a>
                  `
                    )
                    .join("")}
                </div>
              `;
            }

            heroContent.innerHTML = `
              <h1>
                ${hero.title}<br />
                <small class="text-muted">${hero.subtitle}</small>
              </h1>
              <p>${hero.description}</p>
              ${buttonsHtml}
            `;
          }

          if (heroImage && featuredData.heroSection.image) {
            const hero = featuredData.heroSection;
            heroImage.innerHTML = `
              <img src="${hero.image}" alt="พ่อแม่ลูกคิงคอง" class="img-fluid" 
                   width="800" height="600"
                   onerror="this.onerror=null;this.src='data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22800%22 height=%22600%22><rect width=%22100%25%22 height=%22100%25%22 fill=%22%23cccccc%22/><text x=%2250%25%22 y=%2250%25%22 font-size=%2248%22 text-anchor=%22middle%22 fill=%22%23666%22 dy=%22.3em%22>800x600</text></svg>'">
              <div class="image-overlay">
                <div class="image-overlay-text">
                  <i class="${hero.overlay.icon}"></i>
                  <h5>${hero.overlay.title}</h5>
                  <p>${hero.overlay.description}</p>
                </div>
              </div>
            `;
          }
        }
      }

      // Update gallery
      function updateGallery() {
        if (!galleryData || !galleryData.gallery) return;

        // Update gallery title and subtitle
        const galleryTitle = document.querySelector("#gallery .section-title");
        const gallerySubtitle = document.querySelector(
          "#gallery .section-subtitle"
        );

        if (galleryTitle) galleryTitle.textContent = galleryData.gallery.title;
        if (gallerySubtitle)
          gallerySubtitle.textContent = galleryData.gallery.subtitle;

        const galleryContainer = document.querySelector("#gallery .row.g-3");
        if (!galleryContainer) return;

        galleryContainer.innerHTML = "";
        galleryData.gallery.images.forEach((image, index) => {
          const col = document.createElement("div");
          col.className = "col-lg-4 col-md-6";
          col.setAttribute('data-aos', 'zoom-in');
          col.setAttribute('data-aos-delay', (index * 100).toString());
          col.innerHTML = `
            <div class="gallery-item">
              <img src="${image.src}" alt="${image.alt}" class="img-fluid" 
                   width="400" height="250"
                   style="cursor: pointer; transition: transform 0.3s ease;"
                   onmouseover="this.style.transform='scale(1.05)'"
                   onmouseout="this.style.transform='scale(1)'"
                   onerror="this.onerror=null;this.src='data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22250%22><rect width=%22100%25%22 height=%22100%25%22 fill=%22%23cccccc%22/><text x=%2250%25%22 y=%2250%25%22 font-size=%2224%22 text-anchor=%22middle%22 fill=%22%23666%22 dy=%22.3em%22>400x250</text></svg>'">
            </div>
          `;
          galleryContainer.appendChild(col);
        });
      }

      // Update services
      function updateServices() {
        if (!servicesData || !servicesData.services) return;

        const servicesContainer = document.querySelector("#services .row.g-4");
        if (!servicesContainer) return;

        servicesContainer.innerHTML = "";
        servicesData.services.forEach((service, index) => {
          const col = document.createElement("div");
          col.className = "col-lg-4 col-md-6";
          col.setAttribute('data-aos', 'fade-up');
          col.setAttribute('data-aos-delay', (index * 100).toString());
          col.innerHTML = `
            <div class="feature-card">
              <div class="feature-icon">
                <span class="${service.icon}"></span>
              </div>
              <h4>${service.title}</h4>
              <p>${service.description}</p>
            </div>
          `;
          servicesContainer.appendChild(col);
        });

        // Re-apply hover effects to new cards
        document.querySelectorAll('.feature-card').forEach(card => {
          card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-10px)';
            this.style.transition = 'transform 0.3s ease';
          });
          
          card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0)';
          });
        });
      }



      // Update about section
      function updateAbout() {
        if (!aboutData || !aboutData.about) return;

        const aboutContent = document.querySelector("#about .card-body");
        if (!aboutContent) return;

        aboutContent.innerHTML = "";
        aboutData.about.sections.forEach((section) => {
          section.content.forEach((paragraph) => {
            const p = document.createElement("p");
            p.textContent = paragraph;
            aboutContent.appendChild(p);
          });
        });
      }

      // Refresh data function
      function refreshData() {
        console.log("Refreshing homepage data...");
        loadHomepageData();
      }

      // Load homepage data when page loads
      document.addEventListener("DOMContentLoaded", function() {
        loadHomepageData();
        initializeInteractiveFeatures();
      });

      // Initialize all interactive features
      function initializeInteractiveFeatures() {
        // Initialize AOS (Animate On Scroll)
        AOS.init({
          duration: 1000,
          once: true,
          offset: 100
        });

        // Initialize particles.js background
        particlesJS('particles-js', {
          particles: {
            number: { value: 50 },
            color: { value: '#ffffff' },
            shape: { type: 'circle' },
            opacity: { value: 0.3 },
            size: { value: 3 },
            move: {
              enable: true,
              speed: 1,
              direction: 'none',
              out_mode: 'out'
            }
          }
        });

        // Initialize typing animation
        const typedTitle = document.getElementById('typed-title');
        if (typedTitle) {
          new Typed('#typed-title', {
            strings: [
              'ยินดีต้อนรับสู่ห้วยตึงเฒ่า', 
              'โครงการอันเนื่องมาจากพระราชดำริ',
              'พัฒนาชุมชนอย่างยั่งยืน'
            ],
            typeSpeed: 50,
            backSpeed: 30,
            backDelay: 2000,
            loop: true,
            showCursor: true,
            cursorChar: '|'
          });
        }

        // Initialize scroll to top button
        const scrollToTopBtn = document.getElementById('scrollToTop');
        if (scrollToTopBtn) {
          window.addEventListener('scroll', function() {
            if (window.pageYOffset > 300) {
              scrollToTopBtn.style.display = 'block';
              scrollToTopBtn.style.opacity = '1';
            } else {
              scrollToTopBtn.style.opacity = '0';
              setTimeout(() => {
                if (window.pageYOffset <= 300) {
                  scrollToTopBtn.style.display = 'none';
                }
              }, 300);
            }
          });

          scrollToTopBtn.addEventListener('click', function() {
            window.scrollTo({
              top: 0,
              behavior: 'smooth'
            });
          });
        }

        // Initialize counter animations
        const observerOptions = {
          threshold: 0.5,
          rootMargin: '0px 0px -100px 0px'
        };

        const observer = new IntersectionObserver(function(entries) {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const counter = entry.target;
              const target = parseInt(counter.getAttribute('data-count'));
              const countUp = new CountUp(counter, target, {
                duration: 2,
                useEasing: true,
                separator: ','
              });
              countUp.start();
              observer.unobserve(counter);
            }
          });
        }, observerOptions);

        // Observe all counter elements
        document.querySelectorAll('.stat-number').forEach(counter => {
          observer.observe(counter);
        });

        // Add hover effects to service cards
        document.querySelectorAll('.feature-card').forEach(card => {
          card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-10px)';
            this.style.transition = 'transform 0.3s ease';
          });
          
          card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0)';
          });
        });

        // Add interactive gallery with lightbox effect
        document.addEventListener('click', function(e) {
          if (e.target.closest('.gallery-item img')) {
            const img = e.target;
            const modal = document.createElement('div');
            modal.className = 'image-modal';
            modal.style.cssText = `
              position: fixed;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              background: rgba(0,0,0,0.9);
              z-index: 10000;
              display: flex;
              align-items: center;
              justify-content: center;
              cursor: pointer;
            `;
            
            const modalImg = document.createElement('img');
            modalImg.src = img.src;
            modalImg.style.cssText = `
              max-width: 90%;
              max-height: 90%;
              object-fit: contain;
            `;
            
            modal.appendChild(modalImg);
            document.body.appendChild(modal);
            
            modal.addEventListener('click', function() {
              document.body.removeChild(modal);
            });
          }
        });

        // Add smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
          anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
              target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
              });
            }
          });
        });

        // Add loading animation for tables
        const tables = document.querySelectorAll('table tbody');
        tables.forEach(tbody => {
          if (tbody.children.length === 0) {
            tbody.innerHTML = `
              <tr>
                <td colspan="2" class="text-center">
                  <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">กำลังโหลด...</span>
                  </div>
                </td>
              </tr>
            `;
          }
        });
      }
    </script>
  </body>
</html>
