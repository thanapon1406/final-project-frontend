<!DOCTYPE html>
<html lang="th">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>
      สำนักงานโครงการจัดหมู่บ้านตัวอย่างห้วยตึงเฒ่า อันเนื่องมาจากพระราชดำริ
    </title>

    <!-- Bootstrap 5.3.0 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Thai Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css" />

    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
  </head>
  <body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center" href="index.html">
          <!-- Will be loaded from JSON -->
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <!-- Will be loaded from JSON -->
          </ul>
        </div>
      </div>
    </nav>

    <!-- Carousel -->
    <div id="carouselMain" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-indicators">
        <!-- Will be loaded from JSON -->
      </div>
      <div class="carousel-inner">
        <!-- Will be loaded from JSON -->
      </div>
      <button
        class="carousel-control-prev"
        type="button"
        data-bs-target="#carouselMain"
        data-bs-slide="prev"
      >
        <span class="carousel-control-prev-icon"></span>
      </button>
      <button
        class="carousel-control-next"
        type="button"
        data-bs-target="#carouselMain"
        data-bs-slide="next"
      >
        <span class="carousel-control-next-icon"></span>
      </button>
    </div>

    <!-- News Marquee -->
    <div class="news-marquee">
      <div class="container-fluid">
        <marquee direction="left" scrollamount="3">
          <!-- Will be loaded from JSON -->
        </marquee>
      </div>
    </div>

    <!-- Main Content -->
    <main id="main-content">
      <!-- Hero Section -->
      <section class="hero-section">
        <div class="container">
          <div class="row align-items-center">
            <div class="col-lg-6">
              <div class="hero-content">
                <!-- Will be loaded from JSON -->
              </div>
            </div>
            <div class="col-lg-6">
              <div class="hero-image">
                <div class="image-container position-relative">
                  <!-- Will be loaded from JSON -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Services Section -->
      <section id="services" class="py-5">
        <div class="container">
          <div class="row g-4">
            <!-- Will be loaded from JSON -->
          </div>
        </div>
      </section>

      <!-- Activity Icons Section -->
      <section class="section-bg-gray py-5">
        <div class="container">
          <div class="row text-center" id="activities">
            <!-- Will be loaded from JSON -->
          </div>
        </div>
      </section>

      <!-- News Section -->
      <section class="py-5">
        <div class="container" id="news">
          <div class="row">
            <div class="col-12">
              <div class="table-responsive">
                <table class="table table-striped">
                  <thead>
                    <tr>
                      <th width="20%">วันที่</th>
                      <th width="80%">รายละเอียด</th>
                    </tr>
                  </thead>
                  <tbody>
                    <!-- Will be loaded from JSON -->
                  </tbody>
                </table>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- About Section -->
      <section id="about" class="section-bg-gray py-5">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <h2 class="section-title">เกี่ยวกับเรา</h2>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-8 mx-auto">
              <div class="card">
                <div class="card-body">
                  <!-- Will be loaded from JSON -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Gallery Section -->
      <section id="gallery" class="py-5">
        <div class="container">
          <div class="row">
            <div class="col-12">
              <h2 class="section-title">ประมวลภาพ</h2>
              <p class="section-subtitle">
                ภาพบรรยากาศและกิจกรรมต่างๆ ที่ห้วยตึงเฒ่า
              </p>
            </div>
          </div>
          <div class="row g-3">
            <!-- Will be loaded from JSON -->
          </div>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <div class="row">
          <div class="col-lg-8">
            <!-- Will be loaded from JSON -->
          </div>
          <div class="col-lg-4 text-end" id="footer-social">
            <!-- Will be loaded from JSON -->
          </div>
        </div>
      </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Shared JS -->
    <script src="js/shared.js"></script>

    <!-- Load Homepage Data from JSON -->
    <script>
      let carouselData = null;
      let newsData = null;
      let featuredData = null;
      let galleryData = null;
      let servicesData = null;
      let aboutData = null;

      // Load homepage-specific JSON data
      async function loadHomepageData() {
        try {
          const [carousel, news, featured, gallery, services, about] =
            await Promise.all([
              loadJsonData("homepage-carousel"),
              loadJsonData("homepage-news"),
              loadJsonData("homepage-featured"),
              loadJsonData("homepage-gallery"),
              loadJsonData("homepage-services"),
              loadJsonData("about-content"),
            ]);

          carouselData = carousel;
          newsData = news;
          featuredData = featured;
          galleryData = gallery;
          servicesData = services;
          aboutData = about;

          // Update page content
          updateCarousel();
          updateNews();
          updateFeatured();
          updateGallery();
          updateServices();
          updateActivities();
          updateAbout();

          console.log("Homepage data loaded successfully");
        } catch (error) {
          console.error("Error loading homepage data:", error);
        }
      }

      // Update carousel
      function updateCarousel() {
        if (!carouselData || !carouselData.slides) return;

        const carouselInner = document.querySelector(
          "#carouselMain .carousel-inner"
        );
        const carouselIndicators = document.querySelector(
          "#carouselMain .carousel-indicators"
        );

        if (!carouselInner || !carouselIndicators) return;

        // Clear existing content
        carouselInner.innerHTML = "";
        carouselIndicators.innerHTML = "";

        const activeSlides = carouselData.slides.filter(
          (slide) => slide.active
        );

        activeSlides.forEach((slide, index) => {
          // Create indicator
          const indicator = document.createElement("button");
          indicator.type = "button";
          indicator.setAttribute("data-bs-target", "#carouselMain");
          indicator.setAttribute("data-bs-slide-to", index);
          if (index === 0) indicator.classList.add("active");
          carouselIndicators.appendChild(indicator);

          // Create slide
          const slideDiv = document.createElement("div");
          slideDiv.className = `carousel-item ${index === 0 ? "active" : ""}`;
          slideDiv.innerHTML = `
            <img src="${slide.image || ""}" class="d-block w-100" alt="${
            slide.title
          }" 
                 width="1200" height="600"
                 onerror="this.onerror=null;this.src='data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%221200%22 height=%22600%22><rect width=%22100%25%22 height=%22100%25%22 fill=%22%23cccccc%22/><text x=%2250%25%22 y=%2250%25%22 font-size=%2248%22 text-anchor=%22middle%22 fill=%22%23666%22 dy=%22.3em%22>1200x600</text></svg>'">
            <div class="carousel-caption">
              <h3>${slide.title}</h3>
              <p>${slide.description}</p>
            </div>
          `;
          carouselInner.appendChild(slideDiv);
        });
      }

      // Update news section
      function updateNews() {
        if (!newsData) return;

        // Update marquee
        const marquee = document.querySelector(".news-marquee marquee");
        if (marquee && newsData.announcements) {
          const activeAnnouncements = newsData.announcements.filter(
            (a) => a.active
          );
          if (activeAnnouncements.length > 0) {
            marquee.innerHTML = activeAnnouncements
              .map((a) => `<strong>ประกาศ:</strong> ${a.text}`)
              .join(" &nbsp;&nbsp;&nbsp;&nbsp; ");
          }
        }

        // Update news table
        const newsTable = document.querySelector("#news tbody");
        if (newsTable && newsData.newsTable) {
          newsTable.innerHTML = "";
          newsData.newsTable.forEach((news) => {
            const row = document.createElement("tr");
            row.innerHTML = `
              <td><strong>${news.date}</strong></td>
              <td>${news.content}</td>
            `;
            newsTable.appendChild(row);
          });
        }
      }

      // Update featured content
      function updateFeatured() {
        if (!featuredData) return;

        // Update hero section
        if (featuredData.heroSection) {
          const heroContent = document.querySelector(".hero-content");
          const heroImage = document.querySelector(
            ".hero-image .image-container"
          );

          if (heroContent) {
            const hero = featuredData.heroSection;
            let buttonsHtml = "";
            if (hero.buttons) {
              buttonsHtml = `
                <div class="hero-buttons">
                  ${hero.buttons
                    .map(
                      (btn) => `
                    <a href="${btn.href}" class="${btn.class}">
                      <i class="${btn.icon} me-2"></i>${btn.text}
                    </a>
                  `
                    )
                    .join("")}
                </div>
              `;
            }

            heroContent.innerHTML = `
              <h1>
                ${hero.title}<br />
                <small class="text-muted">${hero.subtitle}</small>
              </h1>
              <p>${hero.description}</p>
              ${buttonsHtml}
            `;
          }

          if (heroImage && featuredData.heroSection.image) {
            const hero = featuredData.heroSection;
            heroImage.innerHTML = `
              <img src="${hero.image}" alt="พ่อแม่ลูกคิงคอง" class="img-fluid" 
                   width="800" height="600"
                   onerror="this.onerror=null;this.src='data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22800%22 height=%22600%22><rect width=%22100%25%22 height=%22100%25%22 fill=%22%23cccccc%22/><text x=%2250%25%22 y=%2250%25%22 font-size=%2248%22 text-anchor=%22middle%22 fill=%22%23666%22 dy=%22.3em%22>800x600</text></svg>'">
              <div class="image-overlay">
                <div class="image-overlay-text">
                  <i class="${hero.overlay.icon}"></i>
                  <h5>${hero.overlay.title}</h5>
                  <p>${hero.overlay.description}</p>
                </div>
              </div>
            `;
          }
        }
      }

      // Update gallery
      function updateGallery() {
        if (!galleryData || !galleryData.gallery) return;

        // Update gallery title and subtitle
        const galleryTitle = document.querySelector("#gallery .section-title");
        const gallerySubtitle = document.querySelector(
          "#gallery .section-subtitle"
        );

        if (galleryTitle) galleryTitle.textContent = galleryData.gallery.title;
        if (gallerySubtitle)
          gallerySubtitle.textContent = galleryData.gallery.subtitle;

        const galleryContainer = document.querySelector("#gallery .row.g-3");
        if (!galleryContainer) return;

        galleryContainer.innerHTML = "";
        galleryData.gallery.images.forEach((image) => {
          const col = document.createElement("div");
          col.className = "col-lg-4 col-md-6";
          col.innerHTML = `
            <div class="gallery-item">
              <img src="${image.src}" alt="${image.alt}" class="img-fluid" 
                   width="400" height="250"
                   onerror="this.onerror=null;this.src='data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%22400%22 height=%22250%22><rect width=%22100%25%22 height=%22100%25%22 fill=%22%23cccccc%22/><text x=%2250%25%22 y=%2250%25%22 font-size=%2224%22 text-anchor=%22middle%22 fill=%22%23666%22 dy=%22.3em%22>400x250</text></svg>'">
            </div>
          `;
          galleryContainer.appendChild(col);
        });
      }

      // Update services
      function updateServices() {
        if (!servicesData || !servicesData.services) return;

        const servicesContainer = document.querySelector("#services .row.g-4");
        if (!servicesContainer) return;

        servicesContainer.innerHTML = "";
        servicesData.services.forEach((service) => {
          const col = document.createElement("div");
          col.className = "col-lg-4 col-md-6";
          col.innerHTML = `
            <div class="feature-card">
              <div class="feature-icon">
                <i class="${service.icon}"></i>
              </div>
              <h4>${service.title}</h4>
              <p>${service.description}</p>
            </div>
          `;
          servicesContainer.appendChild(col);
        });
      }

      // Update activities
      function updateActivities() {
        if (!featuredData || !featuredData.activities) return;

        const activitiesContainer = document.querySelector("#activities");
        if (!activitiesContainer) return;

        activitiesContainer.innerHTML = "";
        featuredData.activities.forEach((activity) => {
          const col = document.createElement("div");
          col.className = "col-lg-3 col-md-6 mb-4";
          col.innerHTML = `
            <div class="feature-card">
              <img src="${activity.image}" alt="${activity.alt}" 
                   style="border-radius: 5%" class="img-fluid mb-3" 
                   width="240" height="240"
                   onerror="this.onerror=null;this.src='data:image/svg+xml;charset=UTF-8,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2280%22 height=%2280%22><rect width=%22100%25%22 height=%22100%25%22 fill=%22%23cccccc%22 rx=%2240%22/><text x=%2250%25%22 y=%2250%25%22 font-size=%2212%22 text-anchor=%22middle%22 fill=%22%23666%22 dy=%22.3em%22>80x80</text></svg>'">
              <h5>${activity.title}</h5>
            </div>
          `;
          activitiesContainer.appendChild(col);
        });
      }

      // Update about section
      function updateAbout() {
        if (!aboutData || !aboutData.about) return;

        const aboutContent = document.querySelector("#about .card-body");
        if (!aboutContent) return;

        aboutContent.innerHTML = "";
        aboutData.about.sections.forEach((section) => {
          section.content.forEach((paragraph) => {
            const p = document.createElement("p");
            p.textContent = paragraph;
            aboutContent.appendChild(p);
          });
        });
      }

      // Refresh data function
      function refreshData() {
        console.log("Refreshing homepage data...");
        loadHomepageData();
      }

      // Load homepage data when page loads
      document.addEventListener("DOMContentLoaded", loadHomepageData);

      // Add refresh button (for development)
      if (
        window.location.hostname === "localhost" ||
        window.location.hostname === "127.0.0.1"
      ) {
        document.addEventListener("DOMContentLoaded", () => {
          const refreshBtn = document.createElement("button");
          refreshBtn.innerHTML = '<i class="fas fa-sync-alt"></i> รีเฟรชข้อมูล';
          refreshBtn.className = "btn btn-sm btn-outline-info position-fixed";
          refreshBtn.style.cssText = "top: 10px; right: 10px; z-index: 9999;";
          refreshBtn.onclick = refreshData;
          document.body.appendChild(refreshBtn);
        });
      }
    </script>
  </body>
</html>
